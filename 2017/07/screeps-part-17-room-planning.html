<!doctype html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>Screeps Part 17 – Room Planning</title>
    <link rel="stylesheet" href="/css/style.css" />
    <link rel="stylesheet" href="/css/font-awesome/css/all.min.css" />
  </head>
  <body>
    <div class="grid grid-cols-1 lg:grid-cols-layout gap-4">
      <div class="bg-white border-gray-200 border shadow-xl p-2 m-4 lg:mb-0 lg:mr-0 lg:col-start-2 text-center lg:text-left">
        <img src="/assets/profile.jpg" alt="Adam Laycock" class="m-auto" />
        <h2 class="font-light text-2xl">Adam Laycock</h2>
        
        <a href="/">Home</a>
        <a href="/blog/">All Posts</a>
        <a href="/about/">About</a>
        <a href="/uses/">Uses</a>
        <a href="/contact/">Contact</a>
      </div>
      <div class="lg:row-span-2">
        <section class="p-4 lg:pb-0 lg:pl-0">
          <div class="bg-white border-gray-300 border shadow-xl p-2 mb-4">
  <h1 class="font-light text-3xl border-b border-gray-200 mb-4">Screeps Part 17 – Room Planning</h1>
  <ul class="flex gap-2">
    <li>24 July 2017</li>
    
      <li><a href="/tag/screeps">#screeps</a></li>
    
  </ul>
</div>
<div class="bg-white prose border-gray-300 border shadow-xl p-2"><p>This is part 17 of my Screeps story, you can read the whole story <a href="/tag/screeps">here</a>.</p>

<h2 id="a-respawn">A Respawn</h2>

<p>So yeah, fighting tier 3 boosted creeps did not go well. Once they downed a tower in my room that was it, a single tower could not out damage the healing of the creep and the room gets wiped.</p>

<p>My ramparts put up a good fight and in one of my rooms, I did defeat the invader. Of course, another one came along 10 minutes later and destroyed a tower and then the whole room.</p>

<p>The DEFCON system puts towers at the top of the energy supply list which after a prolonged engagement means that my spawning energy gets depleted with no refills.</p>

<p>I already had an active safe mode in the fifth room I had claimed which was stopping me from using another in my main room.</p>

<p>After being wiped in a couple of rooms I decided to respawn closer to the other Overlords. So I’m back building up my rooms again.</p>

<h2 id="new-badge">New Badge</h2>

<p>I’ve grown quite bored of my badge. It has been the same for a few months and it is a bit plain. So it’s time for a new fresher badge.</p>

<p><img src="/assets/2017/07/screeps-part-17-room-planning/badge.png" alt="My new badge" /></p>

<h2 id="room-planning">Room Planning</h2>

<p>Dissi has an awesome tool for creating room plans. These plans are a javascript object with all the buildings and their positions. I have a plan for each room at each control level which means that when a room levels up all the required construction sites get placed straight away and if a building gets destroyed it will be replaced automatically. With a little extra code the room planner will drop a green flag on the first spawn in a room which means that from me placing the purple flag to claim the room its completely automated.</p>

<p>I found getting the position for buildings right, editing the JSON to get things in the right place. Dissi was kind enough to put the source of the planner on GitHub which let me open a couple of <a href="https://github.com/ButAds/ScreepsBuildingPlanner/pull/1">pull</a> <a href="https://github.com/ButAds/ScreepsBuildingPlanner/pull/2">requests</a> with some new features. You can now see the coordinates of your cursor and the rooms terrain makes building plans a bit easier.</p>

<p>You can use the room planner over on <a href="http://screeps.dissi.me/buildingplanner/">dissi’s screeps tools</a>. Once you set the room name you will get that rooms terrain map loaded into the planner.</p>

<h2 id="refactoring">Refactoring</h2>

<p>My code has become a little messy. Utils contains helper functions that are not in use by all my code and for now, I’ve been updating code as and when I needed to. With this respawn things are little quite on the code front so it’s a perfect time to read through and update everything.</p>

<h3 id="utilsmovecreepcreep-target-color">Utils.moveCreep(creep, target, color)</h3>

<p>I wrote this function so that I had 1 call to creep.moveTo which looked up my custom cost matrixes and could be modified later on with any other path finding improvements I wanted to make. It was pretty simple to go through the creeps actor looking for all moveTo calls and replace them.</p>

<h3 id="utilsfindhostilecreepsunit">Utils.findHostileCreeps(unit)</h3>

<p>This function does a hostile creep look up but excludes creeps from my alliance mates. This should allow their creeps to pass into my rooms without triggering the towers &amp; defenders. This, of course, needs every hostile creep find to be replaced with calls to this function.</p>

<h2 id="expansion">Expansion</h2>

<p>Being back at one room means pushing outwards, quickly, to regain the income I had before. This means claiming new rooms and remote mining the others.</p>

<p>I’ve done this a few times now, in fact, this AI has been through all this before. It’s just a case of sitting back and dropping a flag from time to time.</p>

<p>I’m now just waiting until a room hits RCL6. That’s when the development of new features of my AI can resume.</p>

<p>I’m now finally at GCL6! I was at 95% when I respawned the back in part 14 and towards the end of that empire I was only a day or so away from leveling up, then this respawn killed all progress. GCL7 is quite a while off although as I get more rooms upgrading faster it should become a closer goal.</p>

<p><img src="/assets/2017/07/screeps-part-17-room-planning/cover.png" alt="Quite a few rooms now" /></p>

<h2 id="wall--rampart-repair">Wall &amp; Rampart Repair</h2>

<p>My towers burn a lot of my energy repairing my walls and ramparts. Most of the time they are repairing at the least efficient distance and ultimately wasting energy.</p>

<p>Ths solution is to limit the repair of wall/ramparts to a creep which will not waste energy doing the job and places building up walls and ramparts at the same point in the energy supply chain as building. I decided that 1 repairer per room is all I need, it should be able to plod along consistently repairing the defences.</p>

<p>Towers will repair walls and ramparts that are under 20k hit points just to ensure some level of protection in every room and they will repair ramparts that are 2000 above or below the target for the room. This saves me spawning a repairer every time a rampart decays.</p>

<h2 id="get-screeps">Get Screeps</h2>

<p>You can follow my progress on <a href="https://screeps.com/a/#!/profile/Arcath">my profile</a>. Once I reach RC4 I’m not sure how I am going to progress yet.</p>

<p>You can read more about Screeps on their <a href="https://screeps.com/">site</a>. I purchased it through steam giving me the permanent 10 CPU and the desktop client.</p>

<p>You can see my code as it was at the end of this post <a href="https://github.com/Arcath/screeps-code/tree/6c3edfa86f94fbb2ffa94b335c5564b777e00332">here</a>.</p>
</div>
        </section>
        <footer class="mt-4 px-4 lg:px-0">
          &copy; Adam Laycock 2024
        </footer>
      </div>
    </div>
  </body>
</html>