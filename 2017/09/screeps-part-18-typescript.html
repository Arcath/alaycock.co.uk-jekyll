<!doctype html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <link rel="icon" href="/assets/512.png" />
    <title>Screeps Part 18 – Typescript</title>
    <link rel="stylesheet" href="/css/style.css" />
    <link rel="stylesheet" href="/css/font-awesome/css/all.min.css" />
    <meta property="og:title" content="Adam Laycock / Screeps Part 18 – Typescript" />
    <meta property="og:description" content="Swapping my code base to Typescript." />
    <meta property="og:image" content="https://alaycock.co.uk/assets/og-image.png" />
  </head>
  <body>
    <div class="grid grid-cols-1 lg:grid-cols-layout gap-4">
      <div class="bg-white border-gray-200 border shadow-xl p-2 mt-4 mx-4 lg:col-start-2 lg:mx-0 text-center lg:text-left">
        <img src="/assets/profile.jpg" alt="Adam Laycock" class="lg:m-auto w-32 float-left lg:float-none lg:w-full mr-4" />
        <h2 class="font-light text-2xl">Adam Laycock</h2>
        <h3 class="font-light text-lg">EdTech Network Manager & Developer</h3>
        
        <div class="grid grid-cols-3 gap-2 text-center mt-4">
          <a href="/" class="bg-gray-200 p-2 shadow border border-gray-300 hover:shadow-none">Home</a>
          <a href="/blog/" class="bg-gray-200 p-2 shadow border border-gray-300 hover:shadow-none">Posts</a>
          <a href="/talks/" class="bg-gray-200 p-2 shadow border border-gray-300 hover:shadow-none">Talks</a>
          <a href="/about/" class="bg-gray-200 p-2 shadow border border-gray-300 hover:shadow-none">About</a>
          <a href="/uses/" class="bg-gray-200 p-2 shadow border border-gray-300 hover:shadow-none">Uses</a>
          <a href="/contact/" class="bg-gray-200 p-2 shadow border border-gray-300 hover:shadow-none">Contact</a>
        </div>
      </div>
      <div class="lg:row-span-2">
        <section class="p-4 lg:pb-0 lg:pl-0">
          <div class="bg-white border-gray-300 border shadow-xl p-2 mb-4">
  <h1 class="font-light text-3xl border-b border-gray-200 mb-4">Screeps Part 18 – Typescript</h1>
  <ul class="flex gap-2">
    <li>04 September 2017</li>
    
      <li><a href="/tag/screeps">#screeps</a></li>
    
      <li><a href="/tag/typescript">#typescript</a></li>
    
  </ul>
</div>
<div class="bg-white prose border-gray-300 border shadow-xl p-2"><p>This is part 18 of my Screeps story, you can read the whole story <a href="/articles/screeps">here</a>.</p>

<h2 id="typescript">Typescript</h2>

<p>I’ve been seeing a lot of good things said about Typescript on the Screeps slack. Typescript is a version of Javascript created by Microsoft that adds typing to Javascript. Bonzai has written an introduction to typescript over on Screeps World (<a href="https://screepsworld.com/2017/07/typescreeps-getting-started-with-ts-in-screeps/">here</a>) which convinced me.</p>

<p>With typings in my code Typescript gives me warnings if I use a method or functions that don’t exist. If I try to perform logic that needs a number on a string I get a warning. This greatly reduces the errors that get pushed to screeps. I have a lot more confidence in my code now.</p>

<p>I had to create some types to get typescript working as well as I wanted. Take <code class="language-plaintext highlighter-rouge">Utils.inflate</code> I was manually typing the output so I wouldn’t get an error anymore which isn’t right. So I created a type for serialized lists per type of structure. With a few overloads on <code class="language-plaintext highlighter-rouge">Utils.inflate</code> I can now pass it a <code class="language-plaintext highlighter-rouge">SerializedContainers</code> array and get an array of <code class="language-plaintext highlighter-rouge">StructureContainer</code> returned.</p>

<p>I still have some areas where typing could be improved, anywhere I manually type the output of a function feels wrong and I’d love to get rid of it.</p>

<h2 id="power">Power</h2>

<p>Power is going to be a pretty big part of screeps. For now, the only thing we can do with it is collect it. In fact, with no RCL8 rooms, I can collect it but not do anything with it at all. Once I hit RCL8 in one of my rooms I do want to be able to do get on the power wagon straight away so that means stock piling it.</p>

<p>Getting power isn’t easy. It only spawns in the corridor rooms that separate the player blocks. It spawns in power banks that have a lot of hit points and deal all damage back to the creeps that attack it. So to break one I need a healer to heal the attacker and an attacker that can kill it fast enough that it won’t despawn. Once it’s destroyed I need a creep on hand straight away to pick up the power and move it back to my room.</p>

<p>My early attempts have failed to break the power bank. I’m getting better but my main limit at the moment is the size of my creeps which will go up when I get to RCL7/8 in my main room.</p>

<p><img src="/assets/2017/09/screeps-part-18-typescript/power.png" alt="Harvest the power" /></p>

<h2 id="terminals">Terminals</h2>

<p>Now I have RCL6 in more than one room I can make use of terminals to move energy and resources between them.</p>

<p>So far I’m focusing on using energy to help other RCL6 rooms. So if a rooms storage has more than 500K energy in it the terminal in the same room will be filled to 150k from storage. If a rooms storage has less than 300k its terminal will be sent up to 105k energy. If a terminal has more than 50k energy and storage has less than 300k a distributor is spawned to move energy from the terminal out into the room.</p>

<p>If a room <em>recovers</em> and becomes self-profitable it should fill its storage (using energy from the terminal as well) and stop requesting energy.</p>

<p>If there is more than 10k of a mineral in storage it gets moved over to the terminal, once the terminal has more than 1k of the mineral it begins selling it to the market.</p>

<p>I’m getting quite excited for when my empire is mostly RCL8. Looking at my empire now I have 1 highly profitable RCL6 room which is sending energy to the others and propping up my empire. Once it reaches RCL8 it will be able to devote more energy to helping out and in turn get the other rooms to RCL8 faster. When I reach GCL7 and claim another room it should leap forward at RCL6 when there are a load of RCL8 that can send it energy.</p>

<h2 id="shard1">Shard1</h2>

<p>Shards are the new big thing in Screeps. All player code is run for every tick which as you can imagine means a huge amount of processing every tick. On shard0 tick times were getting to nearly 5s per tick. With no way of improving the performance anymore, the developers have created shard1. An independent world which runs separately to shard0 with some portals between them.</p>

<p>Running your code on multiple shards isn’t possible at the moment. The only way onto shard1 is to respawn for now. I will go into more detail on running on multiple shards once I can get onto shard1 through the handy portal near me.</p>

<h2 id="get-screeps">Get Screeps</h2>

<p>You can follow my progress on <a href="https://screeps.com/a/#!/profile/Arcath">my profile</a>. Once I reach RC4 I’m not sure how I am going to progress yet.</p>

<p>You can read more about Screeps on their <a href="https://screeps.com/">site</a>. I purchased it through steam giving me the permanent 10 CPU and the desktop client.</p>

<p>You can see my code as it was at the end of this post <a href="https://github.com/Arcath/screeps-code/tree/1c2a4109076c632dbd88d36187f86d1fbf458e00">here</a>.</p>
</div>
        </section>
        <footer class="mt-4 px-4 lg:px-0">
          &copy; Adam Laycock 2024
        </footer>
      </div>
    </div>
  </body>
</html>